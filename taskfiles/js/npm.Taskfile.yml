# yaml-language-server: $schema=https://taskfile.dev/schema.json
version: "3"

tasks:
  init:
    internal: true
    desc: Initialize NPM
    status:
      - test -f package.json
    cmd: jq --null-input --argjson private true --arg type module '$ARGS.named' > package.json

  lock:
    internal: true
    desc: Lock NPM dependencies
    deps: [init]
    status:
      - test -f package-lock.json
    cmd: npm install --package-lock-only

  install:
    internal: true
    desc: Install NPM dependencies
    deps: [lock]
    sources:
      - package-lock.json
    generates:
      - node_modules/**
    cmd: npm clean-install
